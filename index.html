<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌿 Schafe zählen !!!</title>
    <style>
        /* ... Dein CSS-Code bleibt unverändert ... */
        :root {
            --primary: #4CAF50;
            --secondary: #81C784;
            --background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
        }

        body {
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: var(--background);
            font-family: 'Segoe UI', system-ui, sans-serif;
            position: relative;
            overflow: hidden;
        }

        /* ... Rest des CSS-Codes unverändert ... */
    </style>
</head>
<body>
    <div class="background-art"></div>
    
    <div class="container">
        <h1><span class="emoji">🌙</span> Schäfchen zählen <span class="emoji">🐑</span></h1>

        <div class="input-group">
            <input type="number" id="sheepCount" placeholder="Wie viele Schäfchen hast du gezählt?" min="0">
        </div>

        <button id="submitButton">🏆 Eintragen</button>

        <div class="leaderboard">
            <h2><span class="emoji">🏅</span> Bestenliste</h2>
            <ul id="leaderboard"></ul>
        </div>
    </div>

    <!-- 🔥 WICHTIGE KORREKTUR: Firebase-Compat-Skripte hinzugefügt -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <script>
        // Firebase-Konfiguration
        const firebaseConfig = {
            apiKey: "AIzaSyCfFrvGZ2esnAuDRhj1SG8XfcG0G3N5zF8",
            authDomain: "schafe-df870.firebaseapp.com",
            databaseURL: "https://schafe-df870-default-rtdb.firebaseio.com",
            projectId: "schafe-df870",
            storageBucket: "schafe-df870.firebasestorage.app",
            messagingSenderId: "741265220339",
            appId: "1:741265220339:web:c024e1cec5acd229b80d86"
        };

        // Firebase initialisieren
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // DOM-Elemente
        const elements = {
            sheepCount: document.getElementById('sheepCount'),
            submitButton: document.getElementById('submitButton'),
            leaderboard: document.getElementById('leaderboard')
        };

        // Leaderboard-Eintrag erstellen
        function createLeaderboardItem(entry, index) {
            const li = document.createElement('li');
            li.innerHTML = `
                <div class="rank">${index + 1}.</div>
                <div style="flex-grow: 1">${entry.name}</div>
                <div class="emoji">${'🐑'.repeat(Math.min(entry.count, 5))} ${entry.count}</div>
            `;
            return li;
        }

        // Leaderboard aktualisieren
        function updateLeaderboard() {
            database.ref('leaderboard')
                .orderByChild('count')
                .limitToLast(10)
                .on('value', snapshot => {
                    elements.leaderboard.innerHTML = '';
                    const data = snapshot.val();
                    if (data) {
                        Object.values(data)
                            .sort((a, b) => b.count - a.count)
                            .forEach((entry, index) => {
                                elements.leaderboard.appendChild(createLeaderboardItem(entry, index));
                            });
                    }
                });
        }

        // Eintrag hinzufügen
        elements.submitButton.addEventListener('click', () => {
            const count = parseInt(elements.sheepCount.value);
            
            if (isNaN(count) || count < 0) {
                alert("Bitte gib eine gültige Anzahl ein! 🌸");
                return;
            }

            const name = prompt("Wie heißt du? 🌿");
            if (!name) return;

            // Eintrag in die Datenbank schreiben
            database.ref('leaderboard').push({
                name: name.substring(0, 15),
                count: count,
                timestamp: firebase.database.ServerValue.TIMESTAMP
            });

            elements.sheepCount.value = '';
        });

        // Initialisierung
        updateLeaderboard();
    </script>
</body>
</html>
